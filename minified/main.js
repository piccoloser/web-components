export class Color{constructor(e,t,o,i){[this.r,this.g,this.b,this.a]=[e,t,o,i]}get rgba(){return`rgba(${this.r}, ${this.g}, ${this.b}, ${this.a})`}get rgbArray(){return Array.from("rgb").map(e=>this[e])}brightness(e){return new Color(...this.rgbArray.map(t=>Math.max(0,t+e)),this.a)}opacity(e){return this.a+=e,this.a>1&&(this.a=1),this.a<0&&(this.a=0),this}static fromComputedStyle(e,t=null,o="background"){let i=getComputedStyle(e)[o];"none"==i&&(i=t);let r=i.match(/[\d\.]+/g),[a,d,s,l]=r?r.map(Number):[0,0,0,0];return l||(l=1),new Color(a,d,s,l)}}class TabMenu extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.wrapper=addElement("div",{id:"wrapper"}),this.header=addElement("header",{id:"tabs"}),this.open=!this.hasAttribute("closed"),this.divs=[],[this.backgroundColor,this.inactiveBackgroundColor]=this.#a(),this.color=this.style.color,this.wrapper.appendChild(this.header)}connectedCallback(){let e=addElement("style",{textContent:`a[id^="tab-"] {padding: .25rem .5rem;border-radius: 3px 3px 0 0;background-color: ${this.inactiveBackgroundColor};color: ${this.color};cursor: pointer;user-select: none;}a[id^="tab-"]:hover {background-color: ${this.backgroundColor};}a[id^="tab-"].open {background-color: ${this.backgroundColor};}#tabs {display: flex;gap: .25rem;padding: 0 .25rem;border-bottom: solid 1px ${this.backgroundColor};color: ${this.color};}#tabs.minimized {border-bottom: solid 1px ${this.inactiveBackgroundColor};}#wrapper {display: flex;flex-direction: column;margin: 1rem 0;}#wrapper>div:not(:first-child) {display: none;padding: 1rem;box-sizing: border-box;background-color: ${this.backgroundColor};color: ${this.color};}#wrapper>div:not(:first-child).open {display: block}#wrapper .disabled {opacity: .25;cursor: not-allowed;}`});Object.entries(this.children).forEach(([e,t])=>{let o=addElement("a",{id:`tab-${e}`,textContent:`${this.hasAttribute("numbered")?`${e}: `:""}${t.getAttribute("name")}`,onclick:()=>t.hasAttribute("disabled")?{}:t.classList.contains("open")?this.minimize():this.openTab(e)});t.hasAttribute("disabled")&&o.classList.add("disabled"),this.header.appendChild(o),this.wrapper.appendChild(t),this.divs.push([o,t])}),this.open&&this.openTab(this.getTab(this.getAttribute("open"))),this.shadowRoot.append(e,this.wrapper)}getTab(e){return e?this.divs.findIndex(([t,o])=>o.getAttribute("name")==e):0}minimize(){this.header.classList.add("minimized"),this.divs.forEach(([e,t])=>{e.classList.remove("open"),t.classList.remove("open")})}openTab(e){this.header.classList.remove("minimized"),this.divs.forEach(([t,o])=>{o==this.divs[e][1]?(t.classList.add("open"),o.classList.add("open")):(t.classList.remove("open"),o.classList.remove("open"))})}#a(){let e="rgba(200, 200, 200, 1)",t=/[\d\.]+/g,o=this.style.backgroundColor.match(t)||e.match(t),i=o?o.map(Number):e,r=i.length>3?i.pop():1,a=`rgba(${i.join(", ")}, ${r})`,d=`rgba(${i.join(", ")}, ${Math.max(0,r-.2)})`;return[a,d]}}function closeDialog(e){Array.from(e.children).forEach(e=>e.remove()),e.style.display="none"}customElements.define("tab-menu",TabMenu);let btnCloseStyle=`#btn-close {position: absolute;display: flex;justify-content: center;top: 50%;right: .5rem;transform: translateY(-50%);width: 2rem;height: 2rem;cursor: pointer;--bg: #000;}#btn-close:hover {--bg: #222;}#btn-close::before, #btn-close::after {content: '';display: block;position: absolute;width: 5px;height: 100%;transform: rotate(-45deg);border-radius: 3px;background-color: var(--bg);}#btn-close::after {transform: rotate(45deg);}`;class ModalDialog extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.wrapper=addElement("div",{id:"wrapper"});this.bgColor=Color.fromComputedStyle(this,"rgba(200, 200, 200, 1)"),this.bodyBgColor=this.bgColor.rgba,this.titleBgColor=this.bgColor.brightness(-20).rgba;let e=addElement("style",{textContent:`* {margin: 0;padding: 0;box-sizing: border-box;}#backdrop {position: fixed;top: 0;left: 0;right: 0;bottom: 0;background-color: #0005;}${btnCloseStyle}#dialog-box {display: flex;flex-direction: column;align-items: center;overflow: hidden;position: relative;z-index: 1;min-width: 320px;max-width: 900px;max-height: 600px;border-radius: 5px;color: ${this.style.getPropertyValue("color")||"#000"};}#dialog-title {position: relative;display: block;width: 100%;padding: .5rem 4rem;text-align: center;background-color: ${this.titleBgColor||"#888"};}#dialog-body {display: block;width: 100%;height: 100%;padding: 2rem;background: ${this.bodyBgColor||"#aaa"};}#wrapper {position: fixed;top: 0; left: 0;z-index: 2;display: none;align-items: center;justify-content: center;width: 100vw;height: 100vh;}`});this.shadowRoot.append(e,this.wrapper)}display(e="Dialog",t,o=!1){this.wrapper.querySelector("#dialog-box")&&closeDialog(this.wrapper),this.wrapper.style.display="flex";let i;o||(i=addElement("div",{id:"btn-close"}));let r=addElement("div",{id:"backdrop",onclick:()=>o?{}:closeDialog(this.wrapper)}),a=addElement("div",{id:"dialog-box"});a.appendChild(addElement("h2",{id:"dialog-title",textContent:e}));a.appendChild(addElement("div",{id:"dialog-body"})).appendChild(addElement("div",{innerHTML:t})),this.wrapper.append(r,a),i&&(a.querySelector("#dialog-title").append(i),a.querySelector("#btn-close").onclick=()=>closeDialog(this.wrapper)),this.wrapper.querySelector("#close")&&(this.wrapper.querySelector("#close").onclick=()=>closeDialog(this.wrapper))}}class NonModalDialog extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.wrapper=addElement("div",{id:"wrapper"});this.bgColor=Color.fromComputedStyle(this,"rgba(200, 200, 200, 1)");let e=addElement("style",{textContent:`* {box-sizing: border-box;}${btnCloseStyle}#content {position: absolute;top: 0;left: 50%;transform: translateX(-50%);overflow: hidden;display: flex;flex-direction: column;align-items: center;padding: 1rem;padding-right: 3rem;margin: .5rem;width: 50%;max-width: 80vw;background-color: ${this.bgColor.rgba};border-radius: 5px;--bg: #222;}#wrapper {display: none;z-index: 3;justify-content: center;width: 100%;color: ${this.style.getPropertyValue("color")||"#000"};}#wrapper.top {position: fixed;top: 0;left: 50%;transform: translateX(-50%);}@keyframes modal-lifetime {from {width: 100%;}to {width: 0;}}`});this.wrapper.classList.add("top"),this.shadowRoot.append(e,this.wrapper)}display(e,t=10){let o=this.wrapper.appendChild(addElement("div",{id:"content"}));o.appendChild(addElement("div",{id:"content-body",innerHTML:e})),o.appendChild(addElement("div",{id:"btn-close",onclick:()=>closeDialog(this.wrapper)})),o.appendChild(addElement("div",{style:`position: absolute;bottom: 0;left: 0;height: 4px;width: 100%;background: ${this.bgColor.brightness(-50).rgba};animation: modal-lifetime ${t}s linear;`})),this.wrapper.style.display="flex",t>0&&setTimeout(()=>closeDialog(this.wrapper),1e3*t)}}customElements.define("modal-dialog",ModalDialog),customElements.define("nm-dialog",NonModalDialog);export function addElement(e,t={}){return Object.assign(document.createElement(e),t)}